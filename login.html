<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Login with Twitch</title>

  <style>
    body {
      background: #0d0d0d;
      color: #e0e0e0;
      font-family: Arial, sans-serif;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      height: 100vh;
      margin: 0;
    }
    h1 {
      margin-bottom: 20px;
      color: #7fffd4;
    }
    button {
      background: #6441a5;
      color: white;
      border: none;
      padding: 12px 20px;
      font-size: 18px;
      border-radius: 6px;
      cursor: pointer;
    }
    button:hover {
      background: #7d5bbe;
    }
  </style>
</head>

<body>

  <h1>S3ven's RPG</h1>
  <button id="loginBtn">Login with Twitch</button>

  <script>
    const CLIENT_ID = "5xu3qolkx8ym1altj0c2ecvu9tw6u9";

    // Your Apps Script redirect endpoint
    const REDIRECT_URI =
      "https://script.google.com/macros/s/AKfycbydzeFGOHef1-0VpS6rVsnw--qYcdW5N79mylibTDMGJnBjd3iq4lT5ORrWqbDZHRVVng/exec?page=redirect";

    document.getElementById("loginBtn").addEventListener("click", () => {
      const state = crypto.randomUUID();
      sessionStorage.setItem("oauth_state", state);

      const url =
        `https://id.twitch.tv/oauth2/authorize?client_id=${CLIENT_ID}` +
        `&redirect_uri=${encodeURIComponent(REDIRECT_URI)}` +
        `&response_type=code&scope=user:read:email&state=${state}`;

      window.location.href = url;
    });
  </script>

</body>
</html>
